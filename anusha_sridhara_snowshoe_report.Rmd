---
title: "Anusha_Sridhara_snowshoe_report"
author: "Anusha Sridhara"
date: "11/4/2021"
output: html_document
---

# Overview #
This code wrangles and then visualizes data for global glacial volume loss from 1961-2003 from [NSIDC (National Snow and Ice Data Centre) site](https://nsidc.org/data/G10002/versions/1)

**Data Citation**: Dyurgerov, M. Edited by M. Meier and R. Armstrong. 2002, updated 2005. Glacier Mass Balance and Regime Measurements and Analysis, 1945-2003, Version 1. [Indicate subset used]. Boulder, Colorado USA. NSIDC: National Snow and Ice Data Center. doi: https://doi.org/10.7265/N52N506F 2021-10-04

# Setup #
```{r setup, include=FALSE, warning=FALSE, message=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE)
#attach packages
library(tidyverse)
library(here)
library(janitor)
library(dplyr)
library(ggplot2)
library(lubridate)
library(ggbeeswarm)
library(kableExtra)
library(effsize)
library(broom)
```

# Read in the data #
```{r}
## Read glacial loss data ##
bonanza_hares <- read_csv(here("data", "bonanza_hares.csv"))
```

## For reference, the first 6 lines of the dataset are shown below
```{r}
##Return the first 6 lines:
head(bonanza_hares)
```

```{r}
bonanza_hares_juvenile <- bonanza_hares %>% 
  mutate(date_new = mdy(date)) %>% 
  mutate(year_new = year(date_new)) %>%
  group_by(year_new) %>% 
  filter(age=="j") %>% 
  mutate(site =case_when(
    grid == "bonrip" ~ "Bonanza Riparian",
    grid == "bonbs" ~ "Bonanza Black Spruce",
    grid == "bonmat" ~ "Bonanza Mature"))  
``` 

```{r}
bonanza_hares_juvenile_Count <- bonanza_hares_juvenile %>% 
  group_by(year_new) %>% 
  filter(age=="j") %>% 
  summarize(count=n())
```

```{r}
ggplot(data = bonanza_hares_juvenile_Count, aes(x=year_new, y=count))+
  geom_col(aes(fill = count))+
  theme_get()+
  scale_x_continuous(breaks = c(1999:2012))+
  labs(x = "Years",
       y = "No of Juvenile Hares",
       title = "Number of Juvenile Hares trapped by year",
       caption = "Figure 1: Number of Juvenile Hares trapped from years 1999 to 2012 at Bonanza Creek LTER")
```


```{r}
bonanza_hares_juvenile_summary <- bonanza_hares_juvenile_Count %>% 
  summarize(mean_count =mean(count, na.rm = TRUE),
            median_count =median(count, na.rm = TRUE),
            max_count = max(count, na.rm=TRUE),
            min_count = min(count, na.rm =TRUE),
            sd_count = sd(count, na.rm = TRUE))
```


```{r}
bonanza_hare_weights <- bonanza_hares_juvenile %>% 
  group_by(sex, grid) %>% 
  summarize(mean_weight_gms = mean(weight, na.rm=TRUE))

ggplot(data = bonanza_hares_juvenile, aes(x = sex, y=weight)) +
  geom_beeswarm(aes(color = sex)) +
  scale_color_manual(values = c("goldenrod2","cyan4","coral")) +
  geom_boxplot(fill = NA, width = 0.2, outlier.color = NA) +
  stat_summary(fun=mean, 
               geom="point", 
               shape=20, 
               size=4, 
               color="black", 
               fill="black") +
  theme_minimal() +
  labs(x = "Sex",
       y = "Weight(gms)",
       caption = "Figure 2: Juvenile Hares weights by sex trapped at various sites from years 1999 to 2012 at Bonanza Creek LTER")+
  theme(legend.position = "right")+
  theme_bw()
```

## Juvenile weight comparison (male and female snowshoe hares)
```{r}
juvenile_weight_comparison <- bonanza_hares_juvenile %>% 
  group_by(sex) %>% 
  summarize(mean_count =round(mean(weight, na.rm = TRUE),2),
            median_count =round(median(weight, na.rm = TRUE),2),
            sd_count = round(sd(weight, na.rm = TRUE),2),
            sample_size = n()) %>% 
  kable(col.names = c("Sex",
                      "Mean of Juvenile Hare weight in grams",
                      "Median of Juvenile Hare weight in grams",
                      "Standard Deviation of Juvenile Hare weight in grams",
                      "Total number of Juvenile Hares"),
                      caption = "Table 1: Statistical summary of Juvenile Snowshoe Hare Data from Bonanza Creek LTER") %>% 
  kable_styling(full_width = FALSE)

juvenile_weight_comparison
```
```{r}
#include = false
ggplot(data = bonanza_hares_juvenile, aes(x=weight))+
  geom_histogram(bins=12)+
  facet_wrap(~sex)
```

```{r}
#include = false
ggplot(data = bonanza_hares_juvenile, aes(sample=weight)) +
  geom_qq()+
  geom_qq_line() +
  facet_wrap(~sex)
```

```{r}
weights_male <- bonanza_hares_juvenile %>% 
  filter(sex == "m") %>% 
  drop_na(weight) %>% 
  pull(weight)

weights_female <- bonanza_hares_juvenile %>% 
  filter(sex == "f") %>% 
  drop_na(weight) %>% 
  pull(weight)

t.test_juvenile_hare_Weights <- t.test(weights_male, weights_female)

t.test_juvenile_hare_Weights
```

```{r}
juvenile_Weights_cohen <- cohen.d(weights_male,weights_female)
juvenile_Weights_cohen
```
```{r}
ggplot(data=bonanza_hares_juvenile, aes(x=hindft, y=weight))+
  geom_point(color= "burlywood")+
  theme_classic()+
  geom_smooth(method = "lm")+
  labs(x = "Hind Foot Length in mm",
       y = "Weight in grams",
       caption = expression(
         paste(
           bold("Figure 3:"), "Weight versus Hind Foot Length of Juvenile Hares")))+
  theme(plot.caption = element_text(hjust = 0.5),
        plot.background = element_rect(fill = "grey"),
        panel.background = element_rect(fill = "white"),
        panel.grid.major = element_line(color = "pink"))
```

```{r}
weight_hindft_lm <- lm(hindft ~ weight, data = bonanza_hares_juvenile)

weight_hindft_lm

weight_hindft_lm_tidy <- tidy(weight_hindft_lm)

weight_hindft_lm_tidy
```









## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
